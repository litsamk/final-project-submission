# Cardiotoxicity Transcriptomics Analysis

## Overview

This repository contains code and data to analyze transcriptomic responses to drug treatments in cardiomyocyte cell lines, with a focus on identifying and visualizing cardiotoxicity signatures of four anthrocycline drugs: doxorubicin, daunorubicin, idarubicin, and epirubicin, and the latter three in comparison to doxorubicin. 

Using bulk RNA-seq data from GSE217421, this project performs preprocessing, normalization, dimensionality reduction (PCA/UMAP), clustering, differential gene expression analysis (DESeq2), and Gene Set Enrichment Analysis (GSEA). I

The analysis aims to replicate the UMAP plots from Figure 3 of the draft as well as the PCA. The analysis includes data preprocessing, dimensionality reduction (PCA, UMAP), clustering, and figure generation using bulk RNA-seq data. The code is designed to allow users to regenerate the main analysis figure and results. It generates visualizations and outputs to uncover how the drugs of interest affect cardiotoxic pathways differently.

## Data

The primary dataset consists of gene expression counts and sample metadata for cardiomyocyte cell lines treated with various drugs and DMSO control. The data can be found [GEO Accession GSE217421](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE217421), titled "Transcriptomic profiling of drug-treated human induced pluripotent stem cells (iPSCs)".

- **Expression data:** `GSE217421_raw_counts_GRCh38.p13_NCBI.tsv`
- **Sample metadata:** `Sample_reference.xlsx`
includes label of sample ('Sample name'), the drug it was treated with ('Drug'), the cell line it belongs to ('Cell line'), and which repliate it corresponds to ('Replicate')
- **Drug metadata:** `Drug_reference.txt`
includes code for drug name ('Drug abbreviation'), the name of the drug ('Drug name'), the type of drug it is ('Drug class'), whether it is cardiotoxic  ('Is_cardiotoxic) and to what extent ('Cardiotoxiity frequency') and literature references ('References for cardiotoxicity')


**Data citation:**  
> Churko, J.M., et al. (2023). "Transcriptomic signatures of drug-induced cardiotoxicity in human iPSC-derived cardiomyocytes." GEO Accession GSE217421.

## Folder Structure

Final_project/
│
├── data/ # Input data files 
│ ├── Sample_reference.xlsx
│ ├── Drug_reference.txt
│ └── GSE217421_raw_counts_GRCh38.p13_NCBI.tsv
│
├── ouputs/ # Output figures and result CSVs
│ ├── *.png # Figures (PCA, UMAP, Volcano plots, GSEA plots)
│ └── *.csv # DEG and GSEA result tables
│
├── code/ # Source code
│ └── 440_project.py
│
├── README.md # Project documentation

- **data/**: Contains all input data files required for the analysis. 
- **results/**: Stores all output figures and CSVs generated by the analysis script.
- **code/**: Contains the main analysis script (`440_project.py`).
- **README.md**: This documentation file.

## Installation

### 1. Clone the repository

- git clone https://github.com/litsamk/final_project_submission.git
- cd final_project_submission

### 2. Download dependencies:


In order to run the code, key packages include:
- Python 3.11
- scanpy
- pandas
- numpy
- matplotlib
- openpyxl
- leidenalg
- scikit-learn
- seaborn
- anndata
- python-igraph
- louvain
- xlrd
- scipy
- pydeseq2 
- mygene 
- gseapy


## Execution

Run the code in the following file: python code/440_project.py

## Outputs

PCAplots.png / UMAPplots.png: Dimensionality reduction visualizations

cluster_composition_*.png: Cluster breakdowns by drug or cell line

*_volcano.png: Volcano plots for DEG comparisons

*_10DEGs.png: Heatmaps of top DEGs

GSEA_*.png: GSEA plots for each drug comparison

*.csv: DEG and GSEA result tables

## Citations

- Churko, J.M., et al. (2023). "Transcriptomic signatures of drug-induced cardiotoxicity in human iPSC-derived cardiomyocytes." GEO Accession GSE217421.
- [Scanpy: Single-Cell Analysis in Python](https://scanpy.readthedocs.io/)
- [Leiden algorithm for community detection](https://www.nature.com/articles/s41598-019-41695-z)


**Prepared by:**  
Litsa Kapsalis and Harshit Bhasin
[ Cardiotoxicity Transcriptomics Analysis]  
[GitHub Repo Link: https://github.com/litsamk/final-project-submission/tree/main
Public

